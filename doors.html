<!DOCTYPE html>
<html>
<style>
.topnav {
  padding:20px;
  background-color:transparent;
  overflow:hidden;
}
.topnav a {
  padding: 20px;
  text-decoration: none;
  font-size: 25px;
  color: #818181;
  display: block;
}

.topnav a:hover {
  color: #f1f1f1;
}

body {
	background-color: black;
	color: black;
}
#but {
     background:none;
     border:none;
     margin:0;
     padding:0;
     cursor: pointer;
     color: white;
 }
 video {
    position:center;
    width:800px;
 }
 ul {
	list-style-type:none;
 }
 li {
	padding: 15px;
	color:#818181;
 }
 #hider {
	margin-left: 3%;
 }
</style>
<div class="topnav">
	<a href="/index">/</a>
</div>
<div id="videoContainer" style="display:inline-block"></div>
<b id="output" style="vertical-align:top"></b>
<div id="instructions">
	<ul>
		<li><button onclick="playpause();">play / pause</button> p key </li>
		<li style="font-size:20px;"><button onclick="looper()">loop on / off</button> l key </li>
</div>
<script src="/js/doors_vids.js"></script>
<script src="/js/doors2.js"></script>
<script>
//https://archive.ph/a8job
var videoContainer = document.getElementById('videoContainer'),
    output = document.getElementById('output'),
    nextVideo,
    videoObjects =
    [
        document.createElement('video'),
        document.createElement('video')
    ],
    vidSources = doors_cinema.concat(doors_cinema2, doors_cinema3, doors_tpfwwm, doors_txfftf, doors_txfiwtb)
    //random starting point
    nextActiveVideo = Math.floor((Math.random() * vidSources.length));
shuffle(vidSources);
videoObjects[0].inx = 0; //set index
videoObjects[1].inx = 1;

initVideoElement(videoObjects[0]);
initVideoElement(videoObjects[1]);

videoObjects[0].autoplay = true;
videoObjects[0].src = vidSources[nextActiveVideo];
videoContainer.appendChild(videoObjects[0]);

videoObjects[1].style.display = 'none';
videoContainer.appendChild(videoObjects[1]);

	document.addEventListener('keydown', function(event) {
	    if (event.keyCode == 76 && videoObjects[0].loop == false) {
		    videoObjects[0].loop=true;
	    }
	    else if (event.keyCode == 76 && videoObjects[0].loop == true) {
		    videoObjects[0].loop=false;
  	    }
	    if (event.keyCode == 76 && videoObjects[1].loop == false) {
		    videoObjects[1].loop=true;
	    }
	    else if (event.keyCode == 76 && videoObjects[1].loop == true) {
		    videoObjects[1].loop=false;
  	    }
	    else if (event.keyCode == 80 && videoObjects[0].paused == false) {
		    videoObjects[0].pause();
	    }
	    else if (event.keyCode == 80 && videoObjects[1].paused == false) {
		    videoObjects[1].pause();
	    }
		else if (event.keyCode == 80 && videoObjects[0].style.display == 'block' && videoObjects[0].paused == true) {
		    videoObjects[0].play();
	    }
		else if (event.keyCode == 80 && videoObjects[1].style.display == 'block' && videoObjects[1].paused == true) {
		    videoObjects[1].play();
	    }
		else if (event.keyCode == 80 && !videoObjects[0].style.display && videoObjects[1].style.display == 'none') {
		    videoObjects[0].play();
	    }
});
function initVideoElement(video)
{
    video.playsinline = true;
    video.muted = false;
    video.preload = 'auto'; //but do not set autoplay, because it deletes preload

    //loadedmetadata is wrong because if we use it then we get endless loop
    video.onplaying = function(e)
    {
        //output.innerHTML = 'Current video source index: ' + nextActiveVideo;

        //select next index. If is equal vidSources.length then it is 0
        nextActiveVideo = ++nextActiveVideo % vidSources.length;

        //replace the video elements against each other:
        if(this.inx == 0)
            nextVideo = videoObjects[1];
        else
            nextVideo = videoObjects[0];

        nextVideo.src = vidSources[nextActiveVideo];
        nextVideo.pause();
    };

    video.onended = function(e)
    {
        this.style.display = 'none';
        nextVideo.style.display = 'block';
        nextVideo.play();
    };
}

function playpause() {
	    if (videoObjects[0].paused == false) {
		    videoObjects[0].pause();
	    }
	    else if (videoObjects[1].paused == false) {
		    videoObjects[1].pause();
	    }
		else if (videoObjects[0].style.display == 'block' && videoObjects[0].paused == true) {
		    videoObjects[0].play();
	    }
		else if (videoObjects[1].style.display == 'block' && videoObjects[1].paused == true) {
		    videoObjects[1].play();
	    }
		else if (!videoObjects[0].style.display && videoObjects[1].style.display == 'none') {
		    videoObjects[0].play();
	    }
}
function looper() {
	    if (videoObjects[0].loop == false) {
		    videoObjects[0].loop=true;
	    }
	    else if (videoObjects[0].loop == true) {
		    videoObjects[0].loop=false;
  	    }
	    if (videoObjects[1].loop == false) {
		    videoObjects[1].loop=true;
	    }
	    else if (videoObjects[1].loop == true) {
		    videoObjects[1].loop=false;
            }
}
</script>
